!! IOS XR Configuration 6.3.1
!
lldp
exit
!
xml agent tty iteration off
!
hostname AS65000_PE2
!
line console
 exec-timeout 0 0
 session-timeout 0
!
line default
 exec-timeout 0 0
 session-timeout 0
 !ipv4 unnumbered mpls traffic-eng Loopback0
ipv4 prefix-list PR-TUNNEL
 10 permit 172.16.0.11/32
 20 permit 172.16.0.33/32
 30 permit 172.16.0.44/32
!
!
interface Gi0/0/0/0
 description Border Interface
 ipv4 address 10.2.0.0/31
 no shutdown
!
interface Gi0/0/0/0.1001
 description TO_AS65001_CE2
 ipv4 address 10.1.0.3/31
 encapsulation dot1q 1001
!
interface Gi0/0/0/1.1001
 description TO_AS65001_CE1
 ipv4 address 10.1.0.5/31
 encapsulation dot1q 1001
!
!
interface Gi0/0/0/2
 description TO_EDGE_PE1
 ipv4 address 10.0.0.1/31
 no shutdown
!
!
interface Gi0/0/0/3
 description TO_CORE_P2
 ipv4 address 10.0.0.4/31
 no shutdown
!
!
interface Loopback0
 description SYSTEM_LO_IP
 ipv4 address 172.16.0.22/32
 no shutdown
route-policy PL-iBGP-RR-OUT
set next-hop self
end-policy
!
route-policy PL-EBGP-CE1-OUT
  set med 200
  pass
end-policy
!
route-policy PL-EBGP-CE2-OUT
  set med 100
  pass
end-policy
!
route-policy PL-EBGP-65001-IN
  pass
end-policy
!
!
router isis core
 is-type level-2-only
 net 49.0000.1720.1600.0022.00
 address-family ipv4 unicast
  metric-style wide
  mpls traffic-eng level-2-only
  maximum-paths 8
 !
!
interface Gi0/0/0/2
 point-to-point
 address-family ipv4 unicast
  metric 200 level 2
!
interface Gi0/0/0/3
 point-to-point
 address-family ipv4 unicast
interface Loopback0
 passive
 address-family ipv4 unicast
 !
!
router bgp 65000
bgp router-id 172.16.0.22
address-family ipv4 unicast
additional-paths receive
additional-paths send
!
neighbor-group RR
 remote-as 65000
 update-source Loopback0
 address-family ipv4 unicast
 route-policy PL-iBGP-RR-OUT out
 soft-reconfiguration inbound always
!
neighbor 172.16.0.201
use neighbor-group RR
!
neighbor 172.16.0.202
use neighbor-group RR
!
!
neighbor 10.1.0.4
 remote-as 65001
 update-source Gi0/0/0/1.1001
 address-family ipv4 unicast
 soft-reconfiguration inbound always
 route-policy PL-EBGP-65001-IN in
 route-policy PL-EBGP-CE1-OUT out
!
neighbor 10.1.0.2
 remote-as 65001
 update-source Gi0/0/0/0.1001
 address-family ipv4 unicast
 soft-reconfiguration inbound always
 route-policy PL-EBGP-65001-IN in
 route-policy PL-EBGP-CE2-OUT out
!
!
router static
 address-family ipv4 unicast
  0.0.0.0/0 Null0
 !
 
mpls oam
!
mpls ldp
!
!
!
mpls traffic-eng
interface Gi0/0/0/2
!
mpls traffic-eng
interface Gi0/0/0/3
!
!
group GR-LSP
interface 'tunnel-te.*'
ipv4 unnumbered Loopback0
fast-reroute protect node
autoroute announce
exit
record-route
path-option 1 dynamic
no shutdown
exit
exit
interface tunnel-te11
 apply-group GR-LSP
 signalled-name PE2—>PE1
 destination 172.16.0.11
 no shutdown
interface tunnel-te33
 apply-group GR-LSP
 signalled-name PE2—>PE3
 destination 172.16.0.33
 no shutdown
interface tunnel-te44
 apply-group GR-LSP
 signalled-name PE2—>PE4
 destination 172.16.0.44
 no shutdown

